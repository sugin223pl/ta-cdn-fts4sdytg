($WP="undefined"!=typeof $WP?$WP:[]).push({id:"vr.traveler-inputs-and-rap",d:["vendor-babel","vendor-react-libs","@ta/vr.traveler-input-picker","ta-platform","@ta/vr.rap","@ta/vr.inquiry","lithium-platform","@ta/cpm.ad-target","@ta/vr.common","ta-common"],e:["./roots/vr/traveler-inputs-and-rap/TravelerInputsAndRap.jsx"],x:{"./roots/vr/traveler-inputs-and-rap/TravelerInputsAndRap.jsx":["default"]},m:{"./roots/vr/traveler-inputs-and-rap/TravelerInputsAndRap.jsx":function(e,t,r){"use strict";r.r(t);var a=r("@babel/runtime/helpers/esm/objectSpread"),n=r.n(a),o=r("@babel/runtime/helpers/esm/classCallCheck"),i=r.n(o),s=r("@babel/runtime/helpers/esm/possibleConstructorReturn"),l=r.n(s),d=r("@babel/runtime/helpers/esm/getPrototypeOf"),p=r.n(d),u=r("@babel/runtime/helpers/esm/createClass"),c=r.n(u),v=r("@babel/runtime/helpers/esm/inherits"),m=r.n(v),h=r("@babel/runtime/helpers/esm/assertThisInitialized"),g=r.n(h),I=r("@babel/runtime/helpers/esm/defineProperty"),f=r.n(I),y=r("react"),R=r("@ta/vr.traveler-input-picker"),b=r("@ta/common.tracking"),_=r.n(b),E=r("@ta/vr.rap"),k=r("@ta/vr.inquiry"),M=r("@ta/common.api"),T=r("@ta/common.features"),F=r("@ta/common.state"),S=r("@ta/cpm.ad-target"),D=r.n(S),q=r("@ta/vr.common"),C=r("@ta/common.i18n"),O=r("@ta/styleguide.loading"),w={topSectionCopy:"vr-traveler-inputs-and-rap-TravelerInputsAndRap__topSectionCopy--20Ui_",topSectionCopyError:"vr-traveler-inputs-and-rap-TravelerInputsAndRap__topSectionCopyError--2_Gua",topSection:"vr-traveler-inputs-and-rap-TravelerInputsAndRap__topSection--XlK_V",mobileInfoContainer:"vr-traveler-inputs-and-rap-TravelerInputsAndRap__mobileInfoContainer--26s2e",wrapperForPriceHat:"vr-traveler-inputs-and-rap-TravelerInputsAndRap__wrapperForPriceHat--2ecSc",container:"vr-traveler-inputs-and-rap-TravelerInputsAndRap__container--2hejg",mobileInquiryButton:"vr-traveler-inputs-and-rap-TravelerInputsAndRap__mobileInquiryButton--kWR7n",vrrRailAd:"vr-traveler-inputs-and-rap-TravelerInputsAndRap__vrrRailAd--2mUq0"},A=function e(){return y.createElement("div",{className:w.container},y.createElement(O.LoadingSpinner,null))},P=function(e){function t(e){var r;return i()(this,t),r=l()(this,p()(t).call(this,e)),f()(g()(g()(r)),"onInputsChange",function(e){var t=n()({},r.state,e,{showMissingRequiredFields:!1}),a={start:t.startDate,end:t.endDate,adults:t.adults,pets:t.pets,kids:t.kids};Object(q.persistTravelerInfo)(a),r.props.setVrTravelerInfo(a),r.setState(e)}),f()(g()(g()(r)),"showMissingRequireFields",function(){r.setState({showMissingRequiredFields:!0})}),f()(g()(g()(r)),"goToRates",function(){var e=document.querySelector("#vr-detail-page-rates-and-fees");e&&window.scroll({top:e.offsetTop,behavior:"smooth"})}),f()(g()(g()(r)),"renderMobileSendMessageButton",function(){return r.state.startDate&&r.state.endDate&&y.createElement(q.Fade,{key:"send-message-button"},y.createElement("div",{className:w.mobileInquiryButton},y.createElement(k.InquiryButton,{buttonText:Object(C.localize)("vr_tip_send_message_14cd"),readonlyMode:r.props.readonlyMode,modalId:k.MODAL_ID,rental:r.props.rental,type:k.InquiryButtonStyles.PRIMARY,isFullwidth:!0})))}),r.state=t.travelerInfoToPartialState(e.travelerInfo),r}return m()(t,e),c()(t,null,[{key:"getDerivedStateFromProps",value:function e(r,a){var n=r.travelerInfo;return t.isTravelerInfoModified(n,a)?t.travelerInfoToPartialState(n):{}}},{key:"isTravelerInfoModified",value:function e(t,r){var a=r.startDate,n=r.endDate,o=r.adults,i=r.pets,s=r.kids,l=t.start,d=t.end,p=t.adults,u=t.pets,c=t.children;return!(a===l&&n===d&&o===p&&i===u&&s===c)}},{key:"travelerInfoToPartialState",value:function e(t){var r=t.start,a=t.end,n=t.adults,o=t.pets,i=t.children;return{startDate:r?new Date(r):null,endDate:a?new Date(a):null,adults:n,pets:o,kids:i,showMissingRequiredFields:!1}}}]),c()(t,[{key:"getErrorCopy",value:function e(){if(this.state.showMissingRequiredFields)return Object(C.localize)("vr_inquiry_missing_required_error_ffffdcba");var t=this.getFirstRapError();return t&&t.message}},{key:"getFirstRapError",value:function e(){if(!this.props.rapResponse)return null;var t=this.props.rapResponse.errors;return t&&t.length&&t[0]}},{key:"renderRapErrorOrBookedCount",value:function e(){var t,r,a=this.props.rental.paymentStats&&this.props.rental.paymentStats.totalPayments,n=this.getErrorCopy();return n?(t=n,r=n):a&&(t="booked-count",r=y.createElement(y.Fragment,null,y.createElement("span",{className:"ui_icon credit-card"})," ",Object(C.localize)("vr_travelers_booked_this_property_plural",{0:a}))),r?y.createElement(q.Fade,{in:!0,key:t},y.createElement("div",{className:"".concat(w.topSectionCopy," ").concat(n?w.topSectionCopyError:"")},r)):null}},{key:"renderInputs",value:function e(t){var r,a=this.state,n=a.startDate,o=a.endDate,i=a.adults,s=a.pets,l=a.kids,d=a.showMissingRequiredFields,p="MOBILE"===this.props.deviceType,u=this.getFirstRapError();return r=d?"NO_DATES":u?u.reason:void 0,y.createElement(R.TravelerInputsPicker,{onInputsChange:this.onInputsChange,startDate:n,endDate:o,adults:i||2,pets:s,setTarget:t,numberOfMonths:p?1:2,kids:l,calendarData:this.props.calendarData,startDateOverlayAlignEdge:p?"left":"right",endDateOverlayAlignEdge:"right",errorReason:r,includePetsFilter:this.props.rental.requiresPetInput,withTracking:!0,tripSearch:Object(T.featureIsEnabled)("vr_pdp_tripsearch_inputs")})}},{key:"renderWithFooter",value:function e(){var t=this.props,r=t.rapResponse,a=t.rental,n=t.travelerInfo,o=t.detailId,i=t.geoId,s=t.readonlyMode,l=t.isRapLoading,d=t.trackingUid;return y.createElement("div",{className:w.mobileInfoContainer},y.createElement("div",{className:w.topSection},this.renderRapErrorOrBookedCount(),this.renderInputs()),Object(E.shouldShowInquiryButton)(a,r)?this.renderMobileSendMessageButton():null,y.createElement(E.RapFooter,{rapResponse:{data:r},rental:a,travelerInfo:n,detailId:o,geoId:i,readonlyMode:s,trackingUid:d,loading:l,showMissingRequireFields:this.showMissingRequireFields,onGoToFees:this.goToRates,locale:this.props.locale}),y.createElement(k.ConnectedModalInquiryForm,{modalId:k.MODAL_ID}))}},{key:"renderForPlacement",value:function e(){var t=this.props,r=t.rapResponse,a=t.rental,n=t.travelerInfo,o=t.detailId,i=t.geoId,s=t.readonlyMode,l=t.isRapLoading,d=t.trackingUid,p=t.locale;return y.createElement("div",{className:w.wrapperForPriceHat},y.createElement("div",{className:w.container},y.createElement("div",{className:w.topSection},this.renderRapErrorOrBookedCount(),this.renderInputs()),y.createElement(E.RapView,{rapResponse:{data:r},rental:a,travelerInfo:n,detailId:o,geoId:i,readonlyMode:s,trackingUid:d,loading:l,showMissingRequireFields:this.showMissingRequireFields,onGoToFees:this.goToRates,locale:p}),y.createElement(k.ConnectedModalInquiryForm,{modalId:k.MODAL_ID})),y.createElement(D.a,{size:"300x250",position:"a",additionalWrapperClass:w.vrrRailAd}))}},{key:"render",value:function e(){return"MOBILE"===this.props.deviceType?this.renderWithFooter():this.renderForPlacement()}}]),t}(y.Component),j=function(e){function t(){return i()(this,t),l()(this,p()(t).apply(this,arguments))}return m()(t,e),c()(t,[{key:"componentDidUpdate",value:function e(t){t.isInquiryModalShowing&&!this.props.isInquiryModalShowing&&_()({module:"VR",action:"VR_Close_inquiryform_VRR"})}},{key:"renderTravelerInputsAndRap",value:function e(){var t=this.props.loading,r="MOBILE"===this.props.deviceType;return t&&!r?y.createElement(A,null):y.createElement(P,this.props)}},{key:"render",value:function e(){return this.props.isInline||"MOBILE"!==this.props.deviceType?this.renderTravelerInputsAndRap():null}}]),t}(y.Component),B=Object(M.bind)({data:function e(t,r){k.ConnectedInquiryForm.stage(t,r);var a=t.travelerInfo.vr;if(!a)return function(){return{}};var n=t.route,o=n.detail,i=n.geo,s=t.meta.readonlyMode,l=Object(q.getRapUrl)(a,o,t.auth.csrfToken),d=l&&r(l),p=r("".concat("/data/1.0/vr/rental/").concat(o)),u=r("".concat("/data/1.0/vr/rental/calendarData/").concat(o));return E.PriceHat.stage(t,r),function(){return{detailId:o,geoId:i,travelerInfo:t.travelerInfo.vr,rapResponse:d&&d.get().data||d&&d.get().error&&{errors:[{reason:"API_ERROR",message:Object(C.localize)("vr_please_refresh")}]},isRapLoading:!!d&&d.get().loading,rental:p.get().data,loading:!!d&&d.get().loading||u.get().loading||p.get().loading,regionCode:"US",calendarData:u.get().data,readonlyMode:s,trackingUid:t.tracking.uid,deviceType:t.meta.device.viewportCategory,isInquiryModalShowing:t.overlays.global===k.MODAL_ID,locale:t.i18n.locale}}},actions:{setVrTravelerInfo:F.actions.travelerInfo.setVrTravelerInfo}})(j);t.default=Object(M.loadOnMount)(B)}}});
//# sourceMappingURL=vr.traveler-inputs-and-rap.2c305318e0.js.map