($WP="undefined"!=typeof $WP?$WP:[]).push({id:"@ta/memx.google-onetap-api",d:["vendor-babel","vendor-react-libs","vendor-redux-libs","vendor-common","lithium-platform","ta-platform"],e:["./packages/memx/google-onetap-api/index.jsx"],x:{"./packages/memx/google-onetap-api/index.jsx":["default","GOOGLE_SMARTLOCK_DOMAIN","GOOGLE_SMARTLOCK_ORIGIN"]},m:{"./packages/memx/google-onetap-api/index.jsx":function(e,t,o){"use strict";o.r(t);var n=o("@babel/runtime/helpers/esm/classCallCheck"),r=o.n(n),a=o("@babel/runtime/helpers/esm/createClass"),i=o.n(a),c=o("@babel/runtime/helpers/esm/possibleConstructorReturn"),s=o.n(c),l=o("@babel/runtime/helpers/esm/getPrototypeOf"),u=o.n(l),d=o("@babel/runtime/helpers/esm/inherits"),m=o.n(d),g=o("@babel/runtime/helpers/esm/assertThisInitialized"),p=o.n(g),h=o("@babel/runtime/helpers/esm/defineProperty"),f=o.n(h),v=o("react"),k=o("react-redux"),b=o("lodash/get"),y=o.n(b),_=o("@ta/common.features"),O=o("@ta/common.tracking"),A=o.n(O),N=o("@ta/common.logging"),x=o.n(N),E="",w="",I="".concat(),L=5e3,P=1e4,C="google-smartlock-api-js",G={supportedAuthMethods:["https://accounts.google.com"],supportedIdTokenProviders:[{uri:"https://accounts.google.com",clientId:"1070328450902.apps.googleusercontent.com"}]},M={type:"googleYoloNotLoaded",message:"The google yolo library was not yet loaded."};function S(e){x.a.warn("Unknown error processing Google onetap request - type: ".concat(e.type,", message: ").concat(e.message))}var j=function(e){function t(e){var o;return r()(this,t),o=s()(this,u()(t).call(this,e)),f()(p()(p()(o)),"googleyolo",void 0),f()(p()(p()(o)),"iframeAttributeObserver",void 0),f()(p()(p()(o)),"iframeNode",void 0),f()(p()(p()(o)),"loaded",void 0),f()(p()(p()(o)),"classNames",void 0),f()(p()(p()(o)),"addClassName",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0};return o.classNames.push({className:e,predicate:t}),p()(p()(o))}),f()(p()(p()(o)),"load",function(e,t){return new Promise(function(n){if(o.loaded&&o.googleyolo&&n(),o.loaded=!0,window.onGoogleYoloLoad=function(r){if(o.googleyolo=r,r){var a=Object(_.featureIsEnabled)("google_onetap_timeout_10s")?P:L;r.setTimeouts(t||a)}e&&o.googleyolo&&o.googleyolo.setRenderMode(e),n()},null===document.getElementById(C)){var r=document.createElement("script");r.id=C,r.src=w,r.async=!0,null!=document.body&&document.body.appendChild(r)}})}),f()(p()(p()(o)),"captureIframeEvents",function(e){return o.captureIframeNode().then(function(t){o.registerHeightListener(t,e)}),p()(p()(o))}),f()(p()(p()(o)),"trackSuccess",function(e,t){t.idToken&&o.trackAction("".concat(e,"_selected"))}),o.loaded=!1,o.classNames=[],o}return m()(t,e),i()(t,[{key:"componentWillUnmount",value:function e(){if(window.onGoogleYoloLoad=void 0,this.googleyolo){var t=this.googleyolo.cancelLastOperation;this.googleyolo=null,t()}this.iframeAttributeObserver&&this.iframeAttributeObserver.disconnect()}},{key:"reevaluateStylePredicates",value:function e(){var t=this;if(!this.iframeNode||0===this.classNames.length)return this;var o=[];return this.classNames.forEach(function(e){!t.iframeNode||e.predicate&&!e.predicate()?o.push(e):t.iframeNode.classList.add(e.className)}),this.classNames=o,this}},{key:"hint",value:function e(){var t=this;return this.googleyolo?(this.reevaluateStylePredicates().trackAction("hint_requested"),new Promise(function(e,o){return t.googleyolo&&t.googleyolo.hint(G).then(function(o){t.trackSuccess("hint",o),e(o)},function(e){t.trackError("hint",e),o(e)}).catch(function(e){var n=Object.assign({type:"unexpectedException"},e);t.trackException("hint",n),o(e)})})):(this.trackAction("hint_sdk_not_initialized"),Promise.reject(M))}},{key:"retrieve",value:function e(){var t=this;return this.googleyolo?(this.reevaluateStylePredicates().trackAction("autologin_requested"),new Promise(function(e,o){return t.googleyolo&&t.googleyolo.retrieve(G).then(function(o){t.trackSuccess("autologin",o),e(o)},function(e){t.trackError("autologin",e),o(e)}).catch(function(e){var n=Object.assign({type:"unexpectedException"},e);t.trackException("autologin",n),o(n)})})):(this.trackAction("autologin_sdk_not_initialized"),Promise.reject(M))}},{key:"trackError",value:function e(t,o){switch(o.type){case"userCanceled":this.trackAction("".concat(t,"_closed"));break;case"noCredentialsAvailable":this.trackAction("".concat(t,"_no_credentials"));break;case"requestFailed":this.trackAction("".concat(t,"_request_failed"));break;case"unsupportedBrowser":this.trackAction("".concat(t,"_unsupported_browser"));break;case"operationCanceled":break;case"illegalConcurrentRequest":case"initializationError":case"configurationError":default:this.trackAction("".concat(t,"_unknown_error")),S(o)}}},{key:"trackException",value:function e(t,o){this.trackAction("".concat(t,"_exception")),S(o)}},{key:"captureIframeNode",value:function e(){var t=this;return new Promise(function(e){var o=new MutationObserver(function(n){n.forEach(function(n){n.addedNodes&&Array.prototype.forEach.call(n.addedNodes,function(n){"IFRAME"===n.nodeName&&n.src.includes(I)&&(o.disconnect(),t.iframeNode=n,t.reevaluateStylePredicates(),e(n))})})});o.observe(window.document.body,{childList:!0})})}},{key:"registerHeightListener",value:function e(t,o){this.iframeAttributeObserver=new MutationObserver(function(e){var t=parseInt(y()(e,"[0].target.style.height",0),10),n=isNaN(t)?0:t;o.call(o,n)}),this.iframeAttributeObserver.observe(t,{attributes:!0})}},{key:"trackAction",value:function e(t){return A()({module:this.props.trackingModule,action:t,context:"".concat(t,"_").concat(this.props.servlet||"unknown","_").concat(this.props.flow),value:this.props.pid}),this}},{key:"render",value:function e(){return this.props.render(this)}}]),t}(v.Component),R=Object(k.connect)(function(e){return{servlet:e.meta.initialServletName}})(j);o.d(t,"GOOGLE_SMARTLOCK_DOMAIN",function(){return""}),o.d(t,"GOOGLE_SMARTLOCK_ORIGIN",function(){return E}),t.default=R}}});
//# sourceMappingURL=memx.google-onetap-api.614df8022f.js.map
