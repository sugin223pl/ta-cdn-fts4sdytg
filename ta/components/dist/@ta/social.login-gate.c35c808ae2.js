($WP="undefined"!=typeof $WP?$WP:[]).push({id:"@ta/social.login-gate",d:["vendor-babel","vendor-react-libs","vendor-redux-libs","lithium-platform","@ta/social.failover","vendor-apollo-libs","ta-platform","@ta/common.webview","@ta/tracking.interactions","@ta/overlays.fullscreen-overlay","ta-common","@ta/overlays.pieces","@ta/events.keyboard-event-listener"],e:["./packages/social/login-gate/index.jsx"],x:{"./packages/social/login-gate/AuthGated.jsx":["a"],"./packages/social/login-gate/index.jsx":["SocialLoginGate","MemberHardGate","TermsOfUseOverlay","SocialOpener","AuthGated","TermsOverlayQuery"]},m:{"./node_modules/webpack/buildin/global.js":function(e,n){var t;t=function(){return this}();try{t=t||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(t=window)}e.exports=t},"./packages/social/login-gate/AuthGated.jsx":function(e,n,t){"use strict";(function(e){var r=t("@babel/runtime/helpers/esm/objectSpread"),o=t.n(r),a=t("@babel/runtime/helpers/esm/classCallCheck"),l=t.n(a),i=t("@babel/runtime/helpers/esm/createClass"),s=t.n(i),c=t("@babel/runtime/helpers/esm/possibleConstructorReturn"),u=t.n(c),m=t("@babel/runtime/helpers/esm/getPrototypeOf"),d=t.n(m),f=t("@babel/runtime/helpers/esm/inherits"),p=t.n(f),v=t("@babel/runtime/helpers/esm/defineProperty"),g=t.n(v),y=t("react"),O=t("react-redux"),h=t("react-apollo"),b=t("@ta/common.routing"),k=t("@ta/common.webview"),E=t("@ta/tracking.interactions"),w=function(n){function t(){return l()(this,t),u()(this,d()(t).apply(this,arguments))}return p()(t,n),s()(t,[{key:"formatInteraction",value:function e(n){var t=this.props.tracking;return t?{variables:{interaction:g()({},t.source,g()({},n,o()({element:t.element},t.attributes||{})))}}:null}},{key:"renderInner",value:function n(t,r){var o=this.props,a=o.loggedInUserId,l=o.pid,i=o.flowOrigin,s=o.flow,c=o.extraQueryParams,u=o.onClose,m=o.children,d=o.closeX,f=o.closeOnDocClick,p=o.windowShadeOption;return m(function n(o){return new Promise(function(n){if(a)n();else if(k.NativeBridge.isNativeWebview())k.NativeBridge.showRegistration(!1);else{var m={flow:s||"CORE_COMBINED",pid:o||l||-1,userRequestedForce:!0,extraQueryParams:c||{},locationId:r||-1,onSuccess:function e(r){t("modalSuccess"),n(r)},onClose:u,closeX:d,closeOnDocClick:f,windowShadeOption:p};i&&(m.extraQueryParams.flowOrigin=i),e.require(["trjs!ta/registration/RegOverlay"],function(e){t("elementClick"),e.showRegOverlayByPageModel(null,null,window.require("page-model"),m)})}})},a)}},{key:"render",value:function e(){var n=this;return y.createElement(b.RouteConsumer,null,function(e){var t=e.route;return y.createElement(h.Mutation,{mutation:E.LogInteractionV4},function(e){return n.renderInner(function t(r){var o=n.formatInteraction(r);o&&e(o)},t.geo)})})}}]),t}(y.Component);g()(w,"defaultProps",{closeX:!0,closeOnDocClick:!0,windowShadeOption:"dark"}),n.a=Object(O.connect)(function(e){return{loggedInUserId:e.auth.loggedInUserId}})(w)}).call(this,t("./node_modules/webpack/buildin/global.js"))},"./packages/social/login-gate/index.jsx":function(e,n,t){"use strict";t.r(n);var r=t("@babel/runtime/helpers/esm/objectSpread"),o=t.n(r),a=t("@babel/runtime/helpers/esm/classCallCheck"),l=t.n(a),i=t("@babel/runtime/helpers/esm/createClass"),s=t.n(i),c=t("@babel/runtime/helpers/esm/possibleConstructorReturn"),u=t.n(c),m=t("@babel/runtime/helpers/esm/getPrototypeOf"),d=t.n(m),f=t("@babel/runtime/helpers/esm/inherits"),p=t.n(f),v=t("@babel/runtime/helpers/esm/assertThisInitialized"),g=t.n(v),y=t("@babel/runtime/helpers/esm/defineProperty"),O=t.n(y),h=t("react"),b=t("react-redux"),k=t("@ta/common.features"),E=t("@ta/social.failover"),w=t("./packages/social/login-gate/AuthGated.jsx"),C=t("react-apollo"),S=t("@ta/common.logging"),_=t.n(S),P=t("@ta/overlays.fullscreen-overlay"),T=t.n(P),R=t("@ta/overlays.managers"),U=t("@ta/overlays.pieces"),I=t("@ta/platform.import"),M={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"TermsOverlay"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"insightProfile"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uiCardsState"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"states"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"getTermOfUseAcceptanceInfo"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"accepted"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:167}};M.loc.source={body:"34460b78ddd8"};var x=M,j={position:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},N=Object(I.deferredImport)("@ta/social.confirm-username","ConfirmUsername"),F=function e(n){var t=n.onComplete,r=n.children;return h.createElement(C.Query,{query:x},function(e){var n=e.loading,o=e.data,a=e.error;if(n)return null;if(o){var l=o.getTermOfUseAcceptanceInfo&&o.getTermOfUseAcceptanceInfo.accepted,i=o.insightProfile&&o.insightProfile.uiCardsState;return l&&i&&function e(n){return n.states.find(function(e){return"ONBOARDING_CONFIRM_USER"===e.id&&"COMPLETED"===e.state})}(i)?(t(),null):r}return a&&_.a.warn("Error in SkipIfCompleted query: ".concat(a)),_.a.warn("TermsOfUseOverlay was shown due to lack of sufficient information or a query error."),r})},A=function e(n){var t=function e(t){return h.createElement("div",{className:"social-login-gate-TermsOfUseOverlay__container--2SESV"},h.createElement("div",{className:"social-login-gate-TermsOfUseOverlay__bodyContent--3eGDZ"},h.createElement(N,{onComplete:n.onComplete,closerForError:t,trackingModule:"Social_onboarding_gatedaction"})))},r=function e(){return h.createElement(R.Closer,null,function(e){var r=function t(){e(),n.onClose&&n.onClose()};return n.fullscreen?h.createElement(h.Fragment,null,h.createElement(T.a,null,t(r))):h.createElement(h.Fragment,null,h.createElement(U.BlockScroll,null),h.createElement(U.Backdrop,{close:function e(){}},h.createElement(U.Overlay,j,t(r))))})};return n.forceTermsOfUse?h.createElement(r,null):h.createElement(F,{onComplete:n.onComplete},h.createElement(r,null))};A.defaultProps={fullscreen:!1,onClose:void 0,forceTermsOfUse:!1};var B=Object(b.connect)(function(e,n){return{fullscreen:n.fullscreenAlways||"MOBILE"===e.meta.device.viewportCategory}})(A),D=t("@ta/events.keyboard-event-listener"),G=t.n(D),L={position:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},q=function e(n){var t=h.createElement("div",{className:"social-login-gate-ReadonlyMessageOverlay__container--1l9mx"},h.createElement("div",{className:"social-login-gate-ReadonlyMessageOverlay__bodyContent--1bBv0"},n.children),h.createElement(U.CloseX,{close:n.closer}));return n.fullscreen?h.createElement(h.Fragment,null,h.createElement(T.a,null,t)):h.createElement(h.Fragment,null,h.createElement(U.BlockScroll,null),h.createElement(U.Backdrop,{close:n.closer},h.createElement(U.Overlay,L,t),h.createElement(G.a,{keyName:"Escape",callback:n.closer})))};q.defaultProps={fullscreen:!1};var Q=Object(b.connect)(function(e,n){return{fullscreen:n.fullscreenAlways||"MOBILE"===e.meta.device.viewportCategory}})(q),X=function(e){function n(){var e,t;l()(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return t=u()(this,(e=d()(n)).call.apply(e,[this].concat(o))),O()(g()(g()(t)),"state",{openTermsOfUseOverlay:!1,onSuccess:function e(){},forceTermsOfUse:!1,openReadonlyOverlay:!1}),O()(g()(g()(t)),"closeTermsOfUseOverlay",function(){t.setState({openTermsOfUseOverlay:!1,onSuccess:function e(){}})}),O()(g()(g()(t)),"openReadonlyOverlay",function(){t.setState({openReadonlyOverlay:!0})}),O()(g()(g()(t)),"closeReadonlyOverlay",function(){t.setState({openReadonlyOverlay:!1})}),t}return p()(n,e),s()(n,[{key:"render",value:function e(){var n=this,t=this.props,r=t.pid,a=t.flowOrigin,l=t.flow,i=t.children,s=t.onClose,c=t.onLoginSuccess,u=t.tracking,m=t.isReadonlyMode,d=t.extraRegParams;return h.createElement(w.a,{pid:r,flowOrigin:a,flow:l,extraQueryParams:o()({},d,{social:!0}),onClose:s,tracking:u},function(e,t){var r=m?function e(){return n.openReadonlyOverlay(),Promise.reject()}:Object(k.featureIsEnabled)("social_2018_login_gate")?function t(r){return e(r).then(function(e){c&&c();var t=e&&(e.hasCreatedMember||!e.hasAcceptedTermsOfUse);return e&&!t||Object(k.featureIsEnabled)("social_2018_login_gate_skip_terms_of_service")?Promise.resolve():new Promise(function(e){n.setState({openTermsOfUseOverlay:!0,forceTermsOfUse:t,onSuccess:function t(){e(),n.setState({openTermsOfUseOverlay:!1,onSuccess:function e(){}})}})})})}:function e(){return Promise.resolve()};return h.createElement(h.Fragment,null,i(r,t),n.state.openTermsOfUseOverlay&&h.createElement(B,{onComplete:n.state.onSuccess,forceTermsOfUse:n.state.forceTermsOfUse,onClose:n.closeTermsOfUseOverlay}),n.state.openReadonlyOverlay&&h.createElement(Q,{closer:n.closeReadonlyOverlay},h.createElement(E.FailoverMessage,null)))})}}]),n}(h.Component);O()(X,"defaultProps",{pid:-1,flowOrigin:void 0,flow:void 0,tracking:void 0,onLoginSuccess:void 0});var W=Object(b.connect)(function(e){return{isReadonlyMode:e.meta.readonlyMode}})(X),$=t("@ta/common.tracking"),H=t.n($),V=function(e){function n(){return l()(this,n),u()(this,d()(n).apply(this,arguments))}return p()(n,e),s()(n,[{key:"componentDidMount",value:function e(){this.track("member_gate_mounted")}},{key:"track",value:function e(n){H()({module:this.props.trackingModule,action:this.props.isControl?"".concat(n,"_ghost"):n})}},{key:"render",value:function e(){var n=this.props,t=n.pid,r=n.flowOrigin,o=n.flow,a=n.onLoginSuccess,l=n.tracking;return!this.props.isControl&&!this.props.isReadonlyMode&&h.createElement(w.a,{pid:t,flowOrigin:r,flow:o,tracking:l,closeX:!1,closeOnDocClick:!1,windowShadeOption:"light"},function(e){return e().then(function(){return a&&a(),Promise.resolve()}),h.createElement(h.Fragment,null)})}}]),n}(h.Component);O()(V,"defaultProps",{pid:-1,flowOrigin:"join",flow:"MEMBER_GATE_COMBINED",tracking:void 0,onLoginSuccess:void 0,trackingModule:"memx_hard_gate",isControl:!1});var z=Object(b.connect)(function(e){return{isReadonlyMode:e.meta.readonlyMode}})(V),Z=function e(n){var t=n.name,r=n.local,o=n.pid,a=n.children;return h.createElement(W,{pid:o},function(e){return h.createElement(R.Opener,{name:t,local:r},function(n,t){return a(function(){e().then(n)},t)})})};Z.defaultProps={local:!1,pid:void 0};var J=Z;t.d(n,"SocialLoginGate",function(){return W}),t.d(n,"MemberHardGate",function(){return z}),t.d(n,"TermsOfUseOverlay",function(){return B}),t.d(n,"SocialOpener",function(){return J}),t.d(n,"AuthGated",function(){return w.a}),t.d(n,"TermsOverlayQuery",function(){return x})}}});
//# sourceMappingURL=social.login-gate.c35c808ae2.js.map