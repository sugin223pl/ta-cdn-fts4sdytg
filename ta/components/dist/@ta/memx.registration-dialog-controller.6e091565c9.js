($WP="undefined"!=typeof $WP?$WP:[]).push({id:"@ta/memx.registration-dialog-controller",d:["vendor-babel","vendor-react-libs","@ta/memx.google-onetap","@ta/memx.hard-gate-controller","@ta/memx.ta-twotap","@ta/memx.facebook-onetap","@ta/memx.google-onetap-api","vendor-redux-libs","@ta/hotels.trip-search-autopop","lithium-platform","ta-platform","@ta/common.localstorage","@ta/memx.app-download-dialog","@ta/memx.registration-dialog-utils"],e:["./packages/memx/registration-dialog-controller/RegistrationDialogController.jsx"],x:{"./packages/memx/registration-dialog-controller/RegistrationDialogController.jsx":["default"]},m:{"./packages/memx/registration-dialog-controller/RegistrationDialogController.jsx":function(e,t,o){"use strict";o.r(t);var a=o("@babel/runtime/helpers/esm/classCallCheck"),i=o.n(a),n=o("@babel/runtime/helpers/esm/possibleConstructorReturn"),s=o.n(n),r=o("@babel/runtime/helpers/esm/getPrototypeOf"),l=o.n(r),d=o("@babel/runtime/helpers/esm/createClass"),g=o.n(d),p=o("@babel/runtime/helpers/esm/inherits"),c=o.n(p),u=o("@babel/runtime/helpers/esm/assertThisInitialized"),m=o.n(u),b=o("@babel/runtime/helpers/esm/defineProperty"),_=o.n(b),h=o("react"),D=o("@ta/memx.google-onetap"),f=o.n(D),O=o("@ta/memx.hard-gate-controller"),T=o("@ta/memx.ta-twotap"),w=o.n(T),R=o("@ta/memx.facebook-onetap"),v=o.n(R),x=o("@ta/memx.google-onetap-api"),k=o.n(x),A=o("react-redux"),E=o("@ta/hotels.trip-search-autopop"),y=o.n(E),S=o("@ta/common.features"),I=o("@ta/common.radio"),j=o.n(I),N=o("@ta/common.localstorage"),C=o.n(N),G=o("@ta/common.tracking"),M=o.n(G),P=o("@ta/memx.app-download-dialog"),L=o.n(P),F=o("@ta/memx.registration-dialog-utils"),U="google_onetap",V="ta_twotap",W="facebook_onetap",B="app_download_onetap",q=["CORE_COMBINED","CONTENT_SUBMISSION","VOX","MEMX_CORE_COMBINED"],Q=[D.GOOGLE_PID,40563,40600],$=function(e){function t(e){var o;return i()(this,t),o=s()(this,l()(t).call(this,e)),_()(m()(m()(o)),"onGoogleOneTapDismiss",function(){o.trackAction("registration_dialog_google_onetap_dismissed"),Object(F.setRegDialogDismissed)()}),_()(m()(m()(o)),"onGoogleOneTapTriggerNext",function(){o.trackAction("registration_dialog_google_onetap_trigger_next"),o.setState({dialogType:W})}),_()(m()(m()(o)),"onFacebookOneTapDismiss",function(){o.trackAction("registration_dialog_facebook_onetap_dismissed"),Object(F.setRegDialogDismissed)()}),_()(m()(m()(o)),"onFacebookOneTapTriggerNext",function(){o.trackAction("registration_dialog_facebook_onetap_trigger_next"),o.setState({dialogType:V})}),_()(m()(m()(o)),"onTaTwoTapDismiss",function(){o.trackAction("registration_dialog_ta_twotap_dismissed"),o.setState({dialogType:null}),Object(F.setRegDialogDismissed)()}),_()(m()(m()(o)),"onTaTwoTapTriggerNext",function(){o.trackAction("registration_dialog_ta_twotap_trigger_next"),o.setState({dialogType:B})}),_()(m()(m()(o)),"onAppDownloadDialogDismiss",function(){Object(P.trackActionForAppDownload)("closed",o.props.servlet),o.setState({dialogType:null}),Object(P.setAppDownloadDialogDismissed)()}),_()(m()(m()(o)),"onAppDownloadDialogTriggerNext",function(){j()("reg_dialog").emit("all_dismissed")}),_()(m()(m()(o)),"onRegistrationOverlayShown",function(e,t){Q.includes(t)||q.includes(e.toUpperCase())&&Object(S.featureIsEnabled)("google_onetap_inline")&&o.setState({dialogsDisabled:!0})}),_()(m()(m()(o)),"setupRegDialog",function(){var e=o.props.isMember?o.enableAppDownloadDialog:o.enableRegDialog;if(j()("Onboarding").on("loginSuccess",o.disableRegDialog),j()("registration-overlay").on("shown",o.onRegistrationOverlayShown),F.HOTEL_SERVLETS.includes(o.props.servlet)||"ShowUserReviews"===o.props.servlet||"MobileShowUserReviews"===o.props.servlet){if(j()("DatePicker").on("clicked",o.disableRegDialog),j()("global-nav").on("sidebarOpened",o.disableRegDialog),j()("hotels-sort-filter-entry").on("openSort",o.disableRegDialog),j()("hotels-sort-filter-entry").on("openFilters",o.disableRegDialog),j()("hr-persistent-footer").on("show",o.disableRegDialog),j()("h-map").on("open-trigger-clicked",o.disableRegDialog),j()("h-map").on("toggle-trigger-clicked",o.disableRegDialog),j()("rooms-guests").on("popped",o.disableRegDialog),o.props.defaultDates&&!y.a.wasDismissed(o.props.detailPage)&&"MOBILE"===o.props.viewportCategory)return j()("rooms-guests").on("firstUserUpdate",e),j()("picker-autoadvance").on("flow-complete",e),void j()("pop-calendar").on("dismissed",e);j()("responsiveStayDates").on("calendarInteracted",o.disableRegDialog)}if(Object(S.featureIsEnabled)("disable_reg_dialog_for_hardgate")&&parseInt(C.a.get(O.PAGE_VIEWED_KEY),10)>=O.PAGE_COUNT_TRIGGER)o.disableRegDialog();else{if(!Object(F.shouldIgnoreAdhesionUnit)()){var t=window.googletag||{cmd:[]};return t.cmd.push(function(){t.pubads().addEventListener("slotRenderEnded",function(t){(null==t?void 0:t.advertiserId)!==F.ADHESION_COLLAPSE_ADVERTISER_ID&&o.setState({adhesionRendered:!0}),e()})}),j()("cpm_mw_adhesion").on("ad_closed",function(){o.setState({adhesionRendered:!1})}),void setTimeout(e,4e3)}e()}}),_()(m()(m()(o)),"enableRegDialog",function(){null===o.state.dialogType&&o.setState({dialogType:U})}),_()(m()(m()(o)),"enableAppDownloadDialog",function(){o.setState({dialogType:B})}),_()(m()(m()(o)),"disableRegDialog",function(){null!==o.state.dialogType&&o.setState({dialogType:null})}),o.state={dialogType:null,adhesionRendered:!1,dialogsDisabled:!1},o}return c()(t,e),g()(t,null,[{key:"isQualtricsEnabled",value:function e(){return new Promise(function(e){Object(S.featureIsEnabled)("qualtrics_surveys_any")&&window.require(["ta/support/Qualtrics"],function(t){e(t.seenThisPageView()||t.canDisplaySmart()||t.canDisplay())}),e(!1)})}}]),g()(t,[{key:"componentDidMount",value:function e(){var o=this;!this.props.isMember||Object(S.featureIsEnabled)("app_download_toast_including_members")?Object(F.shouldSuppressRegistrationDialog)()&&Object(P.shouldSuppressAppDownloadDialog)()?j()("reg_dialog").emit("all_dismissed"):t.isQualtricsEnabled().then(function(e){e||(o.trackAction("registration_dialog_requested"),o.setupRegDialog())}):j()("reg_dialog").emit("all_dismissed")}},{key:"componentDidUpdate",value:function e(t){!t.isMember&&this.props.isMember&&this.disableRegDialog()}},{key:"trackAction",value:function e(t){M()({module:"registration_dialog",action:t,context:"".concat(this.props.servlet||"unknown")})}},{key:"isAdhesionRendered",value:function e(){return Object(F.doesAdExistOnPage)()||this.state.adhesionRendered}},{key:"render",value:function e(){var t=this,o=this.state,a=o.dialogsDisabled,i=o.dialogType;if(a)return null;switch(i){case U:return Object(F.shouldSuppressRegistrationDialog)()?(this.onGoogleOneTapTriggerNext(),null):(this.trackAction("registration_dialog_google_onetap_rendered"),h.createElement(k.a,{pid:D.GOOGLE_PID,flow:D.GOOGLE_FLOW,trackingModule:D.LOADER_TRACKING_MODULE,render:function e(o){return h.createElement(f.a,{googleApi:o,onDismiss:t.onGoogleOneTapDismiss,triggerNext:t.onGoogleOneTapTriggerNext,adhesionRendered:t.isAdhesionRendered()})}}));case W:return Object(F.shouldSuppressRegistrationDialog)()?(this.onFacebookOneTapTriggerNext(),null):(this.trackAction("registration_dialog_facebook_onetap_rendered"),h.createElement(v.a,{onDismiss:this.onFacebookOneTapDismiss,triggerNext:this.onFacebookOneTapTriggerNext,adhesionRendered:this.isAdhesionRendered()}));case V:return Object(F.shouldSuppressRegistrationDialog)()?(this.onTaTwoTapTriggerNext(),null):(this.trackAction("registration_dialog_ta_twotap_rendered"),h.createElement(w.a,{onDismiss:this.onTaTwoTapDismiss,triggerNext:this.onTaTwoTapTriggerNext,adhesionRendered:this.isAdhesionRendered()}));case B:return Object(P.shouldSuppressAppDownloadDialog)()?(this.onAppDownloadDialogTriggerNext(),null):Object(S.featureIsEnabled)("app_download_toast")||Object(S.featureIsEnabled)("app_download_toast_including_members")?(Object(P.trackActionForAppDownload)("shown",this.props.servlet),h.createElement(L.a,{onDismiss:this.onAppDownloadDialogDismiss,adhesionRendered:this.isAdhesionRendered()})):(Object(S.featureIsEnabled)("corex_ghost_tracking")&&Object(P.trackActionForAppDownload)("shown",this.props.servlet),this.onAppDownloadDialogTriggerNext(),null);default:return null}}}]),t}(h.Component);t.default=Object(A.connect)(function(e){var t;return{isMember:e.auth.isMember,viewportCategory:e.meta.device.viewportCategory,servlet:e.meta.initialServletName,defaultDates:!!(e.travelerInfo.hotels||{}).defaultDates,detailPage:!!(null===(t=e.page)||void 0===t?void 0:t.detailId)}})($)}}});
//# sourceMappingURL=memx.registration-dialog-controller.6e091565c9.js.map