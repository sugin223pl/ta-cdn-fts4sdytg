($WP="undefined"!=typeof $WP?$WP:[]).push({id:"@ta/platform.rum",d:["vendor-react-libs","lithium-platform"],e:["./packages/platform/rum/rum.jsx"],x:{"./packages/platform/rum/rum.jsx":["default"]},m:{"./node_modules/tti-polyfill/tti-polyfill.js":function(t,e,n){(function(n){var r;!function(){var i="undefined"!=typeof window&&window===this?this:void 0!==n&&null!=n?n:this,o="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)};function a(){a=function(){},i.Symbol||(i.Symbol=s)}var u=0;function s(t){return"jscomp_symbol_"+(t||"")+u++}function c(){a();var t=i.Symbol.iterator;t||(t=i.Symbol.iterator=i.Symbol("iterator")),"function"!=typeof Array.prototype[t]&&o(Array.prototype,t,{configurable:!0,writable:!0,value:function(){return d(this)}}),c=function(){}}function d(t){var e=0;return function n(t){return c(),(t={next:t})[i.Symbol.iterator]=function(){return this},t}(function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}})}function f(t){c();var e=t[Symbol.iterator];return e?e.call(t):d(t)}function l(t){if(!(t instanceof Array)){t=f(t);for(var e,n=[];!(e=t.next()).done;)n.push(e.value);t=n}return t}var p=0,m="img script iframe link audio video source".split(" ");function w(t,e){for(var n=(t=f(t)).next();!n.done;n=t.next())if(n=n.value,e.includes(n.nodeName.toLowerCase())||w(n.children,e))return!0;return!1}function v(t,e){if(2<t.length)return performance.now();for(var n=[],r=(e=f(e)).next();!r.done;r=e.next())r=r.value,n.push({timestamp:r.start,type:"requestStart"}),n.push({timestamp:r.end,type:"requestEnd"});for(r=(e=f(t)).next();!r.done;r=e.next())n.push({timestamp:r.value,type:"requestStart"});for(n.sort(function(t,e){return t.timestamp-e.timestamp}),t=t.length,e=n.length-1;0<=e;e--)switch(r=n[e],r.type){case"requestStart":t--;break;case"requestEnd":if(2<++t)return r.timestamp;break;default:throw Error("Internal Error: This should never happen")}return 0}function h(t){t=t||{},this.w=!!t.useMutationObserver,this.u=t.minValue||null,t=window.__tti&&window.__tti.e;var e=window.__tti&&window.__tti.o;this.a=t?t.map(function(t){return{start:t.startTime,end:t.startTime+t.duration}}):[],e&&e.disconnect(),this.b=[],this.f=new Map,this.j=null,this.v=-1/0,this.i=!1,this.h=this.c=this.s=null,function n(t,e){var n=XMLHttpRequest.prototype.send,r=p++;XMLHttpRequest.prototype.send=function(i){for(var o=[],a=0;a<arguments.length;++a)o[a-0]=arguments[a];var u=this;return t(r),this.addEventListener("readystatechange",function(){4===u.readyState&&e(r)}),n.apply(this,o)}}(this.m.bind(this),this.l.bind(this)),function r(t,e){var n=fetch;fetch=function(r){for(var i=[],o=0;o<arguments.length;++o)i[o-0]=arguments[o];return new Promise(function(r,o){var a=p++;t(a),n.apply(null,[].concat(l(i))).then(function(t){e(a),r(t)},function(t){e(t),o(t)})})}}(this.m.bind(this),this.l.bind(this)),function i(t){t.c=new PerformanceObserver(function(e){for(var n=(e=f(e.getEntries())).next();!n.done;n=e.next())if("resource"===(n=n.value).entryType&&(t.b.push({start:n.fetchStart,end:n.responseEnd}),g(t,v(t.g,t.b)+5e3)),"longtask"===n.entryType){var r=n.startTime+n.duration;t.a.push({start:n.startTime,end:r}),g(t,r+5e3)}}),t.c.observe({entryTypes:["longtask","resource"]})}(this),this.w&&(this.h=function o(t){var e=new MutationObserver(function(e){for(var n=(e=f(e)).next();!n.done;n=e.next())"childList"==(n=n.value).type&&w(n.addedNodes,m)?t(n):"attributes"==n.type&&m.includes(n.target.tagName.toLowerCase())&&t(n)});return e.observe(document,{attributes:!0,childList:!0,subtree:!0,attributeFilter:["href","src"]}),e}(this.B.bind(this)))}function y(t){t.i=!0;var e=0<t.a.length?t.a[t.a.length-1].end:0,n=v(t.g,t.b);g(t,Math.max(n+5e3,e))}function g(t,e){!t.i||t.v>e||(clearTimeout(t.j),t.j=setTimeout(function(){var e=performance.timing.navigationStart,n=v(t.g,t.b);if(e=(window.a&&window.a.A?1e3*window.a.A().C-e:0)||performance.timing.domContentLoadedEventEnd-e,t.u)var r=t.u;else r=performance.timing.domContentLoadedEventEnd?(r=performance.timing).domContentLoadedEventEnd-r.navigationStart:null;var i=performance.now();null===r&&g(t,Math.max(n+5e3,i+1e3));var o=t.a;(n=5e3>i-n?null:5e3>i-(n=o.length?o[o.length-1].end:e)?null:Math.max(n,r))&&(t.s(n),clearTimeout(t.j),t.i=!1,t.c&&t.c.disconnect(),t.h&&t.h.disconnect()),g(t,performance.now()+1e3)},e-performance.now()),t.v=e)}h.prototype.getFirstConsistentlyInteractive=function(){var t=this;return new Promise(function(e){t.s=e,"complete"==document.readyState?y(t):window.addEventListener("load",function(){y(t)})})},h.prototype.m=function(t){this.f.set(t,performance.now())},h.prototype.l=function(t){this.f.delete(t)},h.prototype.B=function(){g(this,performance.now()+5e3)},i.Object.defineProperties(h.prototype,{g:{configurable:!0,enumerable:!0,get:function(){return[].concat(l(this.f.values()))}}});var b={getFirstConsistentlyInteractive:function(t){return t=t||{},"PerformanceLongTaskTiming"in window?new h(t).getFirstConsistentlyInteractive():Promise.resolve(null)}};t.exports?t.exports=b:void 0===(r=function(){return b}.apply(e,[]))||(t.exports=r)}()}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./node_modules/webpack/buildin/global.js":function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},"./packages/platform/rum/rum.jsx":function(t,e,n){"use strict";n.r(e);var r=n("react"),i=n("@ta/lithium.context"),o=n("./node_modules/tti-polyfill/tti-polyfill.js"),a=n.n(o),u=new Set(["time-to-interactive","first-paint","first-contentful-paint","cpm-hero-latency","first-input-delay","load"]),s=function t(e,n){return{entryType:"mark",name:e,startTime:n,duration:0}},c=!1;e.default=r.memo(function t(){var e=r.useContext(i.Debug),n=e.puid,o=e.version,d=r.useContext(i.Route).page,f=r.useContext(i.Environment),l=f.domainName,p=f.locale,m=r.useContext(i.Visitor).userId,w=r.useContext(i.Device),v=w.viewportCategory,h=w.isWebview,y=r.useRef({pageLoad:{uid:n,page:d,locale:p.code,revision:o,is_logged_in:null!==m,viewport_category:v,is_webview:h,user_agent:"undefined"!=typeof window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:"unknown",connection_type:"undefined"!=typeof window&&window.navigator&&window.navigator.connection&&window.navigator.connection.effectiveType?window.navigator.connection.effectiveType:"unknown"},navigations:[],resources:[],timings:[]}),g=function t(e){var r=function t(e,n){var r=n.filter(function(t){return"resource"!==t.entryType&&(u.has(t.name)||"measure"===t.entryType&&t.name.startsWith("ðŸ‘·")||"navigation"===t.entryType)});return r.length>0?r.map(function(t){return"navigation"===t.entryType?function t(e,n){return{puid:e,name:n.name,dns:Math.round(n.domainLookupEnd-n.domainLookupStart),ttfb:Math.round(n.responseStart-n.requestStart),download:Math.round(n.responseEnd-n.responseStart),size:n.transferSize}}(e,t):"resource"===t.entryType?function t(e,n){return{puid:e,name:n.name.substring(n.name.indexOf("/","https://".length)),initiator:n.initiatorType,blocked:Math.round(n.requestStart-n.connectEnd),ttfb:Math.round(n.responseStart-n.requestStart),download:Math.round(n.responseEnd-n.responseStart),size:n.transferSize,start:Math.round(n.startTime)}}(e,t):function t(e,n){return{puid:e,name:n.name,type:n.entryType,start:Math.round(n.startTime),duration:Math.round(n.duration)}}(e,t)}):[]}(n,e);if(r.length>0){var i=r.filter(function(t){return"dns"in t}),o=r.filter(function(t){return"initiator"in t}),a=r.filter(function(t){return"duration"in t});y.current.navigations=y.current.navigations.concat(i),y.current.resources=y.current.resources.concat(o),y.current.timings=y.current.timings.concat(a)}};return r.useEffect(function(){var t;if(!c&&(c=!0,!document.hidden&&window.location.hostname===l)){try{if(window.self!==window.top)return}catch(t){}window.navigator&&window.navigator.sendBeacon&&window.addEventListener("unload",function(){window.navigator.sendBeacon("/data/1.0/rum",JSON.stringify(y.current))},!1),(null===(t=window.perfMetrics)||void 0===t?void 0:t.onFirstInputDelay)&&window.perfMetrics.onFirstInputDelay(function(t){g([s("first-input-delay",t)])}),"undefined"!=typeof PerformanceObserver&&new PerformanceObserver(function(t){window.performance&&window.performance.clearResourceTimings&&window.performance.clearResourceTimings(),g(t.getEntries())}).observe({entryTypes:["paint","resource","mark","measure"]}),window.performance&&window.performance.getEntries&&g(window.performance.getEntries()),a.a.getFirstConsistentlyInteractive({}).then(function(t){t&&g([s("time-to-interactive",t)])})}},[]),null})}}});
//# sourceMappingURL=platform.rum.73addda513.js.map