($WP="undefined"!=typeof $WP?$WP:[]).push({id:"@ta/common.location-detail-tag-questions",d:["vendor-babel","vendor-react-libs","@ta/common.localstorage","ta-platform","ta-common","lithium-platform"],e:["./packages/common/location-detail-tag-questions/location-detail-tag-questions.jsx"],x:{"./packages/common/location-detail-tag-questions/location-detail-tag-questions.jsx":["default"]},m:{"./packages/common/location-detail-tag-questions/location-detail-tag-questions.jsx":function(e,t,n){"use strict";n.r(t);var o=n("@babel/runtime/helpers/esm/classCallCheck"),a=n.n(o),s=n("@babel/runtime/helpers/esm/createClass"),i=n.n(s),c=n("@babel/runtime/helpers/esm/possibleConstructorReturn"),l=n.n(c),r=n("@babel/runtime/helpers/esm/getPrototypeOf"),u=n.n(r),m=n("@babel/runtime/helpers/esm/inherits"),d=n.n(m),g=n("@babel/runtime/helpers/esm/assertThisInitialized"),p=n.n(g),h=n("@babel/runtime/helpers/esm/defineProperty"),q=n.n(h),f=n("react"),N=n("@ta/common.localstorage"),_=n.n(N),E=n("@ta/common.logging"),b=n.n(E),x=n("@ta/common.api"),S=n("@ta/styleguide.icon"),k=n("@ta/common.i18n"),w="common-location-detail-tag-questions-location-detail-tag-questions__answer--fscsG",v="common-location-detail-tag-questions-location-detail-tag-questions__ui_icon--2Hvdi",U={YES:"YES",NO:"NO",UNSURE:"UNSURE",UNANSWERED:"UNANSWERED"},A=function(e){function t(e){var n;return a()(this,t),n=l()(this,u()(t).call(this,e)),q()(p()(p()(n)),"localStorageKey","TAG_QUESTION_, ".concat(n.props.locationId)),q()(p()(p()(n)),"newQuestionIndex",function(e){var t=n.answeredQuestionSet();if(null===t&&_.a.set(n.localStorageKey,JSON.stringify([])),n.props.questions)for(var o=e;o<n.props.questions.length;o++)if(n.props.questions[o]&&n.newQuestion(n.props.questions[o].id,t))return o;return-1}),q()(p()(p()(n)),"answeredQuestionSet",function(){var e=_.a.get(n.localStorageKey),t=null;try{e&&e.length&&(t=JSON.parse(e))}catch(e){b.a.error("Failed to parse JSON for Tag Questions: ",e)}return t}),q()(p()(p()(n)),"newQuestion",function(e,t){return!e||!t||t.indexOf(e)<0}),q()(p()(p()(n)),"waitTime",function(e){var t=n.answeredQuestionSet();e>0&&null!==t&&(t.push(e),_.a.set(n.localStorageKey,JSON.stringify(t)));var o=n.newQuestionIndex(n.state.questionIndex+1);setTimeout(function(){n.setState({questionIndex:o,questionAnswer:U.UNANSWERED})},400)}),q()(p()(p()(n)),"recordAnswer",function(e){var t=n.props.questions[n.state.questionIndex].id,o=new URLSearchParams;o.append("format","json"),o.append("a","TAG_VOTE"),o.append("locationId",n.props.locationId.toString()),o.append("id",t.toString()),o.append("value",e),o.append("token",n.props.securityToken),fetch("/ListingQuestionsAjax?".concat(o.toString()),{method:"POST",credentials:"same-origin"}).then(function(e){e.ok?n.waitTime(t):n.handleError(e.statusText)}).catch(function(e){n.handleError(e)})}),q()(p()(p()(n)),"handleError",function(e){b.a.error("Error in saving answer for Tag Question: ",e)}),q()(p()(p()(n)),"clickYes",function(){n.setState({questionAnswer:U.YES}),n.recordAnswer(U.YES)}),q()(p()(p()(n)),"clickNo",function(){n.setState({questionAnswer:U.NO}),n.recordAnswer(U.NO)}),q()(p()(p()(n)),"clickUnsure",function(){n.setState({questionAnswer:U.UNSURE}),n.recordAnswer(U.UNSURE)}),n.state={questionIndex:0,questionAnswer:U.UNANSWERED},n}return d()(t,e),i()(t,[{key:"componentDidMount",value:function e(){this.setState({questionIndex:this.newQuestionIndex(0)})}},{key:"render",value:function e(){var t;if(!(null===(t=this.props.questions)||void 0===t?void 0:t.length))return null;if(-1===this.state.questionIndex)return f.createElement("div",{className:"common-location-detail-tag-questions-location-detail-tag-questions__finalMessage--3DaMn"},f.createElement("span",{className:"common-location-detail-tag-questions-location-detail-tag-questions__messageText--1K2QH"},Object(k.localize)("engage_question_thanks_short")),f.createElement("a",{className:"common-location-detail-tag-questions-location-detail-tag-questions__ctaText--3oAX8",target:"_blank",href:this.props.userReviewUrl},Object(k.localize)("engage_share_another_experience")));var n=this.props.questions[this.state.questionIndex],o=this.state.questionAnswer===U.YES,a=this.state.questionAnswer===U.NO,s=this.state.questionAnswer===U.UNSURE;return f.createElement("div",{className:"common-location-detail-tag-questions-location-detail-tag-questions__questions--409x0"},f.createElement("div",{className:"".concat(this.state.questionAnswer!==U.UNANSWERED?"common-location-detail-tag-questions-location-detail-tag-questions__fade_out--1Y_0V":"common-location-detail-tag-questions-location-detail-tag-questions__fade_in--Q01RT")},f.createElement("span",{className:"common-location-detail-tag-questions-location-detail-tag-questions__questionText--N4iGT","data-id":n.id},Object(k.unescaped)(n.question)),f.createElement("span",{className:"answers"},f.createElement("span",{className:w,onClick:this.clickYes},f.createElement(S.Icon,{name:o?"checkbox-checked":"checkbox-border",className:"".concat(v," ").concat(o?"common-location-detail-tag-questions-location-detail-tag-questions__checkbox_checked--1s0Ux":"")}),f.createElement("span",{className:"text"},Object(k.localize)("common_Yes"))),f.createElement("span",{className:w,onClick:this.clickNo},f.createElement(S.Icon,{name:a?"checkbox-checked":"checkbox-border",className:"".concat(v," ").concat(a?"common-location-detail-tag-questions-location-detail-tag-questions__checkbox_checked--1s0Ux":"")}),f.createElement("span",{className:"text"},Object(k.localize)("common_No"))),f.createElement("span",{className:w,onClick:this.clickUnsure},f.createElement(S.Icon,{name:s?"checkbox-checked":"checkbox-border",className:"".concat(v," ").concat(s?"common-location-detail-tag-questions-location-detail-tag-questions__checkbox_checked--1s0Ux":"")}),f.createElement("span",{className:"text"},Object(k.localize)("mobile_tagsbutton_unsure"))))))}}]),t}(f.Component);q()(A,"defaultProps",{questions:[],locationId:1,securityToken:"",userReviewUrl:""}),t.default=Object(x.bind)(function(e,t){var n=t("/data/1.0/tagQuestions/".concat(e.page.detailId));return function(){return n.get().data||{}}})(A)}}});
//# sourceMappingURL=common.location-detail-tag-questions.537ad42ce5.js.map